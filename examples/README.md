# Ruby XCB Examples

–≠—Ç–æ—Ç –∫–∞—Ç–∞–ª–æ–≥ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Ruby XCB –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω—è—Ö –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

### `/ffi/` - –ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ FFI —Ç–µ—Å—Ç—ã
–ü—Ä—è–º—ã–µ –≤—ã–∑–æ–≤—ã –∫ libxcb —á–µ—Ä–µ–∑ Ruby FFI. –≠—Ç–∏ –ø—Ä–∏–º–µ—Ä—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –±–∞–∑–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ XCB:

- `test_pixmap_ruby.rb` - –ë–∞–∑–æ–≤–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ pixmap –∏ —Ä–∏—Å–æ–≤–∞–Ω–∏—è
- `color_test_ruby.rb` - –†–∞–±–æ—Ç–∞ —Å —Ü–≤–µ—Ç–∞–º–∏ –∏ colormap
- `font_test_ruby.rb` - –ó–∞–≥—Ä—É–∑–∫–∞ —à—Ä–∏—Ñ—Ç–æ–≤ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
- `cursor_test_ruby.rb` - –°–æ–∑–¥–∞–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫—É—Ä—Å–æ—Ä–æ–≤
- `input_grab_test_ruby.rb` - –ü–µ—Ä–µ—Ö–≤–∞—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –∏ –º—ã—à–∏
- `comprehensive_test_ruby.rb` - –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Ç–µ—Å—Ç –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π
- `final_xcb_test_ruby.rb` - –§–∏–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ç–µ—Å—Ç

### `/wrapper/` - –í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π Ruby wrapper
–û–±—ä–µ–∫—Ç–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π Ruby-way API –ø–æ–≤–µ—Ä—Ö FFI:

- `wrapper_test_simple.rb` - –ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏ –æ–∫–Ω–∞
- `wrapper_color_test.rb` - –¢–µ—Å—Ç —Ü–≤–µ—Ç–Ω–æ–π –≥—Ä–∞—Ñ–∏–∫–∏
- `wrapper_font_test.rb` - –¢–µ—Å—Ç —Ä–∞–±–æ—Ç—ã —Å–æ —à—Ä–∏—Ñ—Ç–∞–º–∏
- `wrapper_cursor_test.rb` - –¢–µ—Å—Ç –∫—É—Ä—Å–æ—Ä–æ–≤ —Å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é
- `wrapper_final_test.rb` - –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ç–µ—Å—Ç
- `wrapper_dsl_test.rb` - DSL-—Å—Ç–∏–ª—å –∏ Ruby –∏–¥–∏–æ–º—ã

### `/demos/` - –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
–ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º wrapper.

### `/legacy/` - –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –ø—Ä–∏–º–µ—Ä—ã
–°—Ç–∞—Ä—ã–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã, —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### FFI –ø—Ä–∏–º–µ—Ä—ã
```bash
cd examples/ffi
ruby final_xcb_test_ruby.rb
```

### Wrapper –ø—Ä–∏–º–µ—Ä—ã  
```bash
cd examples/wrapper
ruby wrapper_final_test.rb
```

### DSL —Å—Ç–∏–ª—å
```bash
cd examples/wrapper
ruby wrapper_dsl_test.rb
```

## üìñ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤

| –ê—Å–ø–µ–∫—Ç | FFI | Wrapper |
|--------|-----|---------|
| **–°—Ç–∏–ª—å** | –ü—Ä–æ—Ü–µ–¥—É—Ä–Ω—ã–π | –û–±—ä–µ–∫—Ç–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π |
| **–ü–∞–º—è—Ç—å** | –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ |
| **–°–∏–Ω—Ç–∞–∫—Å–∏—Å** | C-–ø–æ–¥–æ–±–Ω—ã–π | Ruby-way |
| **–ë–ª–æ–∫–∏** | –ù–µ—Ç | –î–∞ |
| **DSL** | –ù–µ—Ç | –î–∞ |

### FFI –ø—Ä–∏–º–µ—Ä:
```ruby
conn = XCB.xcb_connect(nil, nil)
window_id = XCB.xcb_generate_id(conn)
XCB.xcb_create_window(conn, depth, window_id, root, ...)
XCB.xcb_map_window(conn, window_id)
```

### Wrapper –ø—Ä–∏–º–µ—Ä:
```ruby
XCB.connect do |conn|
  window = conn.default_screen.create_window(width: 400, height: 300)
  window.set_title("My App").show
end
```

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- **–ò–∑—É—á–µ–Ω–∏–µ XCB**: –ù–∞—á–Ω–∏—Ç–µ —Å `/ffi/` –ø—Ä–∏–º–µ—Ä–æ–≤
- **–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `/wrapper/` API
- **–ë—ã—Å—Ç—Ä–æ–µ –ø—Ä–æ—Ç–æ—Ç–∏–ø–∏—Ä–æ–≤–∞–Ω–∏–µ**: DSL —Å—Ç–∏–ª—å –∏–∑ `wrapper_dsl_test.rb`

## üîß –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Ruby 2.7+
- libxcb-dev
- X11 —Å–µ—Ä–≤–µ—Ä

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

–í—Å–µ –ø—Ä–∏–º–µ—Ä—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç. "double free" –æ—à–∏–±–∫–∏ –≤ –∫–æ–Ω—Ü–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å.